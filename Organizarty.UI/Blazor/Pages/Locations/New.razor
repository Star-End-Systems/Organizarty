@using Organizarty.Adapters;
@using Organizarty.Application.App.Locations.UseCases;
@using Organizarty.Application.Exceptions;
@using Organizarty.UI.Attributes;

@inject CreateLocationUseCase CreateLocation

<EditForm Model="@Input" id="login" OnSubmit="@Submit" FormName="registeruser" class="w-full h-full flex flex-col items-start justify-center self-center">
  <section class="h-screen w-5/6 ml-auto ">
    <div class="flex flex-col">
      <div class="flex">
        <div class="w-full ml-16">
          <p class="mt-16 font-[KonnectBold] text-4xl text-[#848484]">NOVO LOCAL</p>
          <div class="bg-[#FFC700] rounded-xl h-2 w-52"></div>
        </div>
      </div>
      <p class="ml-16 mt-3 font-[Inter] text-[#848484] text-xl">Preencha as informações abaixo para seus clientes
        poderem
        festejar em mais um local <br> espetacular!</p>
    </div>
    <div class="flex justify-between items-center">
      <div class="h-px w-full bg-[#C5BCBC]"></div>
      <h1 class="p-12 font-[Konnect] text-[#C6C6C6] text-2xl">Endereço</h1>
      <div class="h-px w-full bg-[#C5BCBC]"></div>
    </div>
          <div asp-validation-summary="ModelOnly" class=""></div>
    <div class="flex justify-center ">

      <div class="w-11/12 h-full flex ">
        <div class="w-1/2 flex flex-col justify-between">
          <h2 class="text-[#A09898] font-[Inter] font-bold">CEP: </h2>
          <InputText @bind-Value="@Input.CEP"
            class="font-[KonnectBold] mb-8 w-5/6 h-12 rounded-2xl shadow-xl border-[#FFC700] form-control"
            aria-required="true" />
          <span asp-validation-for="Input.CEP" class="placeholder"></span>

          <h2 class="text-[#A09898] font-[Inter] font-bold">Endereço: </h2>
          <InputText @bind-Value="@Input.Address"
            class="font-[KonnectBold] mb-8 w-5/6 h-12 rounded-2xl shadow-xl border-[#FFC700] form-control"
            aria-required="true" />
          <span asp-validation-for="Input.Address" class="placeholder"></span>

        </div>
      </div>
    </div>
  </section>
  <section class="h-screen w-5/6 ml-auto ">
    <div class="flex justify-between items-center">
      <div class="h-px w-full bg-[#C5BCBC]"></div>
      <h1 class="p-12 font-[Konnect] text-[#C6C6C6] text-2xl">Informações</h1>
      <div class="h-px w-full bg-[#C5BCBC]"></div>
    </div>
    <div class="flex">
      <div class="ml-24 w-1/2 flex flex-col">
        <img class="w-96" src="http://localhost:8000/Clients/" />
      </div>
      <div class="w-1/2 flex flex-col justify-center">
        <h2 class="text-[#A09898] font-[Inter] font-bold">Nome: </h2>
        <InputText @bind-Value="@Input.Name"
          class="font-[KonnectBold] mb-8 w-5/6 h-12 rounded-2xl shadow-xl border-[#FFC700] form-control"
          aria-required="true" />
        <span asp-validation-for="Input.Name" class="placeholder"></span>

        <h2 class="text-[#A09898] font-[Inter] font-bold">Aluguel: </h2>
        <InputNumber @bind-Value="@Input.RentPerDay" type="number"
          class="font-[KonnectBold] mb-8 w-5/6 h-12 rounded-2xl shadow-xl border-[#FFC700] form-control"
          aria-required="true" />
        <span asp-validation-for="Input.RentPerDay" class="placeholder"></span>

        <h2 class="text-[#A09898] font-[Inter] font-bold">Categoria: </h2>
        <InputText @bind-Value="@Input.Category"
          class="font-[KonnectBold] w-5/6 h-12 rounded-2xl shadow-xl border-[#FFC700] form-control"
          aria-required="true" />
        <span asp-validation-for="Input.Category" class="placeholder"></span>

        <h2 class="text-[#A09898] font-[Inter] font-bold">Tamanho (M²)</h2>
        <InputNumber @bind-Value="@Input.AreaSize"
          class="font-[KonnectBold] w-5/6 h-12 rounded-2xl shadow-xl border-[#FFC700] form-control"
          aria-required="true" />
        <span asp-validation-for="Input.AreaSize" class="placeholder"></span>
      </div>
    </div>
    <div class="w-full flex">
      <div class="w-1/2 ml-24 mt-8">
        <p class="font-[KonnectBold] text-[#848484]">Descrição</p>
        <InputText @bind-Value="@Input.Description"
          class="font-[KonnectBold] w-5/6 h-12 rounded-2xl shadow-xl border-[#FFC700] form-control"
          aria-required="true" />
        <span asp-validation-for="Input.Description" class="placeholder"></span>

        <!-- <textarea class="TextArea w-96 h-32"> </textarea> -->
      </div>
      <div class="w-1/2 flex items-end justify-center">
        <div class="flex h-11">
          <button class="font-[Inter] text-[#FFC700] rounded-xl CancelButton pr-10 pl-10">Cancelar</button>
          <button type="submit"
            class="font-[Inter] text-white rounded-xl RegisterButton bg-[#FFC700] pr-10 pl-10 ml-8">Cadastrar</button>
        </div>
      </div>
    </div>
  </section>
</EditForm>

@code{
    public InputModel Input {get; set;} = new();

    public class InputModel
    {
        public string Name { get; set; } = default!;

        public string Description { get; set; } = default!;

        public double AreaSize { get; set; } = default!;

        public decimal RentPerDay { get; set; } = default!;

        public string CEP { get; set; } = default!;

        public string Category { get; set; } = default!;

        public string Address { get; set; } = default!;

        public string Cords { get; set; } = "";

        public string ImgUrl { get; set; } = "http://localhost:8000/Manager/Locations/new";
    }

    public async Task Submit(){
        var data = new CreateLocationDto(Input.Name, Input.Description, Input.AreaSize, Input.RentPerDay, Input.CEP, Input.Category, Input.Address, Input.Cords, new() { Input.ImgUrl });

        try
        {
            var user = await CreateLocation.Execute(data);
        }
        catch (ValidationFailException e)
        {
            foreach (var err in e.Errors)
            {
            }

        }
    }
}
